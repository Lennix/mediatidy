#!/usr/bin/env coffee

program = require 'commander'
Config = require '../lib/config'
Movies = require '../lib/movies'
colors = require 'colors'

program.option('-a, --apiurl <apiurl>', 'API base URL')
  .option('-c, --clientid <clientid>', 'OAuth2 Client ID')
  .option('-s, --clientsecret <clientsecret>', 'OAuth2 Client secret')
  .option('-j, --json', 'display results in JSON')

program.command('update')
  .description('look for for files and directories and add to mediatidy database')
  .action () ->
    console.log '==> '.cyan.bold + 'updating database with current files and directories'
    movie = new Movies Config.get('path')
    movie.update (files, dirs) ->
      movie.dbUpdate files, dirs, ->
        movie.dbRead (files) ->
          console.log files

program.parse process.argv

program.help() if program.args.length is 0
